## Workflow: wf-nanorave-nanopore-amplicon

The wf-nanorave-nanopore-amplicon directory contains scripts and resources for processing Nanopore amplicon data using NanoRave. This directory is structured to facilitate the analysis of genomic data, including importing, processing, and summarizing variant data.

### Directory Structure

```
wf-nanorave-nanopore-amplicon/
|-- input/
|   |-- study/
|       |-- sample_names.csv
|   |-- vcf_to_tsv/
|       |-- clair3/
|       |-- medaka_haploid_variant/
|       |-- medaka_variant/
|       |-- freebayes/
|-- scripts/
|   |-- main-nanopore.R
|-- R.project.Rproj
```

### Subdirectories and Files

- **`input/`**: Contains input data and directories for the analysis.
  - **`project-turkana-embatalk-k13/`**: Directory for storing project-specific files.
    - **`study/`**: Directory for storing study-specific files, such as sample names.
      - **`sample_names.csv`**: CSV file containing sample names.
    - **`vcf_to_tsv/`**: Directory for storing extracted variant files in TSV format, generated using various algorithms.
      - **`clair3/`**: Directory for storing TSV files generated by the Clair3 algorithm.
      - **`medaka_haploid_variant/`**: Directory for storing TSV files generated by the Medaka Haploid Variant algorithm.
      - **`medaka_variant/`**: Directory for storing TSV files generated by the Medaka Variant algorithm.
      - **`freebayes/`**: Directory for storing TSV files generated by the Freebayes algorithm.
- **`scripts/`**: Contains the main R script for processing the data.
  - **`main-nanopore.R`**: The main R script for processing Nanopore amplicon data using NanoRave.
- **`R.project.Rproj`**: RStudio project file for this workflow.

### Dependencies

The scripts in this directory require R (version 4.0.0 or higher) and several R packages, including `tidyverse`, `data.table`, and `janitor`. Ensure you have these packages installed before running the scripts.

### Script Overview

####

The main-nanopore. R script processes TSV files for genomic data analysis.

- It starts by defining a list of directory paths and corresponding algorithms. Each directory contains TSV files associated with a specific genomic sequencing algorithm. The script includes a custom function `read_and_label` which:
- Imports genome BED files and sample names.
- Merges the imported data with the genome BED file.
- Reshapes the data for further analysis.
- Computes allele frequencies and filter based on read depth and algorithm concordance.
